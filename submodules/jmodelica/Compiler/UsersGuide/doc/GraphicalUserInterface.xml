<?xml version="1.0" encoding="UTF-8"?>
<chapter version="5.0" xml:id="ch_graphicaluserinterface"
         xmlns="http://docbook.org/ns/docbook"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xmlns:xs="http://www.w3.org/2001/XMLSchema"
         xmlns:xlink="http://www.w3.org/1999/xlink"
         xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:svg="http://www.w3.org/2000/svg"
         xmlns:m="http://www.w3.org/1998/Math/MathML"
         xmlns:html="http://www.w3.org/1999/xhtml"
         xmlns:db="http://docbook.org/ns/docbook">
  <title>Graphical User Interface for Visualization of Results</title>

  <section>
    <title>Plot GUI</title>

    <para>JModelica.org comes with a graphical user interface (GUI) for
    displaying simulation and / or optimization results. The GUI supports
    result files generated by JModelica.org and Dymola (both binary and
    textual formats).</para>

    <para>The GUI is located in the module
    <literal>(pyjmi/pyfmi).common.plotting.plot_gui</literal> and can be
    started by Windows users by selecting the shortcut located in the
    start-menu under JModelica.org. The GUI can also be started by typing the
    following commands in a Python shell:</para>

    <programlisting language="python">from pyjmi.common.plotting import plot_gui   # or pyfmi.common.plotting import plot_gui
plot_gui.startGUI()
</programlisting>

    <para>Note that the GUI requires the Python package <link
    xlink:href="http://www.wxpython.org/">wxPython</link> which
    is installed by default in the Python version that comes with
    JModelica.org.</para>

    <figure xml:id="fig_gui_overview">
      <title>Overview of JModelica.org Plot GUI</title>

      <mediaobject>
        <imageobject>
          <imagedata fileref="images/overview.png" scalefit="1" width="60%"/>
        </imageobject>
      </mediaobject>
    </figure>

    <section>
      <title>Introduction</title>

      <para>An overview of the GUI is shown in <xref
      linkend="fig_gui_overview"/>. As can be seen, the plot figures are
      located to the right and can contain multiple figures in various
      configurations. The left is dedicated to show the loaded result file(s)
      and corresponding variables together with options for filtering
      time-varying variables and parameters/constants.</para>

      <para>Loading a result file is done using the <literal>File</literal>
      menu selection <literal>Open</literal> which opens a file dialog where
      either textual (.txt) results or binary (.mat) results can be chosen.
      The result is then loaded into a tree structure which enables the user
      to easily browse between components in a model, see <xref
      linkend="fig_gui_first"/> . Multiple results can be loaded either
      simultaneously or separately by using the <literal>File</literal> menu
      option <literal>Open</literal> repeatedly.</para>

      <figure xml:id="fig_gui_first">
        <title>A result file has been loaded.</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="images/FirstLook.png" scalefit="1" width="60%"/>
          </imageobject>
        </mediaobject>
      </figure>

      <para>Displaying trajectories is done by simply checking the box
      associated with the variable of interest, see <xref
      linkend="fig_gui_traj"/>. Removing a trajectory follows the same
      principle.</para>

      <figure xml:id="fig_gui_traj">
        <title>Plotting a trajectory.</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="images/FirstTrajectory.png" scalefit="1"
                       width="60%"/>
          </imageobject>
        </mediaobject>
      </figure>

      <para>A result can also be removed from the tree view by selecting an
      item in the tree and by pressing the delete key.</para>
    </section>

    <section>
      <title>Edit Options</title>

      <para>The GUI allows a range of options, see <xref
      linkend="fig_gui_options"/>, related to how the trajectories are
      displayed such as line width, color and draw style. Information about a
      plot can in addition be defined by setting titles and labels. Options
      related to the figure can be found under the <literal>Edit
      </literal>menu as well as adding more plot figures.</para>

      <figure xml:id="fig_gui_options">
        <title>Figure Options.</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="images/FigureOptions.png" scalefit="1"
                       width="60%"/>
          </imageobject>
        </mediaobject>
      </figure>

      <para>Under <literal>Axis/Labels</literal>, see <xref
      linkend="fig_gui_axis"/>, options such as defining titles and labels in
      both X and Y direction can be found together with axis options.</para>

      <figure xml:id="fig_gui_axis">
        <title>Figure Axis and Labels Options.</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="images/FigureAxis.png" scalefit="1"
                       width="60%"/>
          </imageobject>
        </mediaobject>
      </figure>

      <para>Under <literal>Lines/Legends</literal>, options for specifying
      specific line labels and line styles can be found, see <xref
      linkend="fig_gui_lines"/>. The top drop-down list contains all variables
      related to the highlighted figure and the following input fields down to
      <literal>Legend</literal> are related to the chosen variable. The
      changes take effect after the button <literal>OK</literal> has been
      pressed. For changing multiple lines in the same session, the
      <literal>Apply</literal> button should be used.</para>

      <figure xml:id="fig_gui_lines">
        <title>Figure Lines and Legends options.</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="images/FigureLines.png" scalefit="1"
                       width="60%"/>
          </imageobject>
        </mediaobject>
      </figure>

      <para>Additional figures can be added from the <literal>Add
      Plot</literal> command in the <literal>Edit</literal> menu. In <xref
      linkend="fig_gui_additional"/> an additional figure have been
      added.</para>

      <figure xml:id="fig_gui_additional">
        <title>An additional plot has been added.</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="images/FigurePlot.png" scalefit="1"
                       width="60%"/>
          </imageobject>
        </mediaobject>
      </figure>

      <para>The figures can be positioned by choosing a figure tab and moving
      it to one of the borders of the GUI. In <xref linkend="fig_gui_moving"/>
      "Plot 1" have been dragged to the left side of the figure and a
      highlighted area has emerged which shows where "Plot 1" will be
      positioned. In <xref linkend="fig_gui_moved"/> the result is
      shown.</para>

      <figure xml:id="fig_gui_moving">
        <title>Moving Plot Figure.</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="images/FigureMoving.png" scalefit="1"
                       width="60%"/>
          </imageobject>
        </mediaobject>
      </figure>

      <figure xml:id="fig_gui_moved">
        <title>GUI after moving the plot window.</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="images/FigureMoved.png" scalefit="1"
                       width="60%"/>
          </imageobject>
        </mediaobject>
      </figure>

      <para>If we are to add more figures, an increasingly complex figure
      layout can be created as is shown in <xref linkend="fig_gui_complex"/>
      where figures also have been dragged to other figure headers.</para>

      <figure xml:id="fig_gui_complex">
        <title>Complex Figure Layout.</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="images/FigureComplex.png" scalefit="1"
                       width="60%"/>
          </imageobject>
        </mediaobject>
      </figure>
    </section>

    <section>
      <title>View Options</title>

      <para>Options for interacting with a figure and changing the display can
      be found under the <literal>View</literal> menu. The options are to
      show/hide a grid, either to use the mouse to move the plot or to use the
      mouse for zooming and finally to resize the plot to fit the selected
      variables.</para>

      <figure>
        <title>Figure View Options.</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="images/FigureView.png" scalefit="1"
                       width="60%"/>
          </imageobject>
        </mediaobject>
      </figure>

      <para>Moving a figure with the <literal>move</literal> option is
      performed by simply pressing the left mouse button and while still
      holding down the button, dragging the plot to the area of interest. A
      zoom operation is performed in a similar fashion.</para>
    </section>

    <section>
      <title>Example</title>

      <para><xref linkend="fig_gui_example"/> shows an example of how the GUI
      can be used to plot four different plots with different labels. Some of
      the lines have also been modified in width and in line style. A grid is
      also shown.</para>

      <figure xml:id="fig_gui_example">
        <title>Multiple figure example.</title>

        <mediaobject>
          <imageobject>
            <imagedata fileref="images/MultipleExample.png" scalefit="1"
                       width="60%"/>
          </imageobject>
        </mediaobject>
      </figure>
    </section>
  </section>
</chapter>
